<Application x:Class="RimSharp.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:RimSharp"
             xmlns:vmMods="clr-namespace:RimSharp.ViewModels.Modules.Mods"
             xmlns:vMods="clr-namespace:RimSharp.Views.Modules.Mods"
             xmlns:vmDownloader="clr-namespace:RimSharp.ViewModels.Modules.Downloader"
             xmlns:vDownloader="clr-namespace:RimSharp.Views.Modules.Downloader"
             xmlns:converters="clr-namespace:RimSharp.Views.Converters"
>
    <Application.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <!-- RimWorld Style Resources -->
                <ResourceDictionary>
                    <!-- Global Converters -->
                    <converters:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
                    <converters:InequalityConverter x:Key="InequalityConverter"/>
                    <!-- Colors based on RimWorld UI -->
                    <Color x:Key="RimworldBrown">#4A3A2B</Color>
                    <Color x:Key="RimworldDarkBrown">#372A1F</Color>
                    <Color x:Key="RimworldLightBrown">#8B7A64</Color>
                    <Color x:Key="RimworldBeige">#D0C8B0</Color>
                    <Color x:Key="RimworldDarkBeige">#AA9D85</Color>
                    <Color x:Key="RimworldHighlight">#F7D070</Color>
                    <Color x:Key="RimworldDarkGreen">#2B4933</Color>
                    <Color x:Key="RimworldRed">#9E2A2A</Color>
                    

                    <!-- Brushes -->
                    <SolidColorBrush x:Key="RimworldBrownBrush"
                            Color="{StaticResource RimworldBrown}"/>
                    <SolidColorBrush x:Key="RimworldDarkBrownBrush"
                            Color="{StaticResource RimworldDarkBrown}"/>
                    <SolidColorBrush x:Key="RimworldLightBrownBrush"
                            Color="{StaticResource RimworldLightBrown}"/>
                    <SolidColorBrush x:Key="RimworldBeigeBrush"
                            Color="{StaticResource RimworldBeige}"/>
                    <SolidColorBrush x:Key="RimworldDarkBeigeBrush"
                            Color="{StaticResource RimworldDarkBeige}"/>
                    <SolidColorBrush x:Key="RimworldHighlightBrush"
                            Color="{StaticResource RimworldHighlight}"/>
                    <SolidColorBrush x:Key="RimworldDarkGreenBrush"
                            Color="{StaticResource RimworldDarkGreen}"/>
                    <SolidColorBrush x:Key="RimworldRedBrush"
                            Color="{StaticResource RimworldRed}"/>
        <SolidColorBrush x:Key="RimworldErrorBrush" Color="#b52828"/>


                    <!-- Custom Border Style for RimWorld-like panels -->
                    <Style x:Key="RimworldPanelBorder"
                            TargetType="Border">
                        <Setter Property="Background"
                                Value="{StaticResource RimworldDarkBeigeBrush}"/>
                        <Setter Property="BorderBrush"
                                Value="{StaticResource RimworldBrownBrush}"/>
                        <Setter Property="BorderThickness"
                                Value="2"/>
                        <Setter Property="CornerRadius"
                                Value="3"/>
                        <Setter Property="Padding"
                                Value="8"/>
                        <Setter Property="Effect">
                            <Setter.Value>
                                <DropShadowEffect Color="#222222"
                                        Direction="320"
                                        ShadowDepth="2"
                                        BlurRadius="4"
                                        Opacity="0.3"/>
                            </Setter.Value>
                        </Setter>
                    </Style>

                   <!-- RimWorld-style Button -->
<Style x:Key="RimworldButtonStyle" TargetType="Button">
    <Setter Property="Foreground" Value="#FFFFFF"/>
    <Setter Property="Padding" Value="8,4"/>
    <Setter Property="MinWidth" Value="80"/>
    <Setter Property="MinHeight" Value="24"/>
    <Setter Property="FontWeight" Value="Medium"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="Button">
                <Grid>
                    <!-- Base button with slight offset shadow effect -->
                    <Border x:Name="ButtonBackground"
                            Background="{StaticResource RimworldBrownBrush}"
                            BorderBrush="{StaticResource RimworldDarkBrownBrush}"
                            BorderThickness="1"
                            CornerRadius="3"
                            Margin="0,0,0,2">
                        <Border.Effect>
                            <DropShadowEffect Color="#222222"
                                    Direction="320"
                                    ShadowDepth="1"
                                    BlurRadius="2"
                                    Opacity="0.3"/>
                        </Border.Effect>
                    </Border>

                    <!-- Content with subtle inner shadow -->
                    <Border Background="Transparent"
                            BorderBrush="{StaticResource RimworldDarkBrownBrush}"
                            BorderThickness="1"
                            CornerRadius="3"
                            Margin="0,0,0,2">
                        <ContentPresenter HorizontalAlignment="Center"
                                VerticalAlignment="Center"/>
                    </Border>
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Background" TargetName="ButtonBackground" Value="{StaticResource RimworldLightBrownBrush}"/>
                    </Trigger>
                    <Trigger Property="IsPressed" Value="True">
                        <Setter Property="Margin" TargetName="ButtonBackground" Value="0,1,0,1"/>
                    </Trigger>
                    <Trigger Property="IsEnabled" Value="False">
                        <Setter Property="Background" TargetName="ButtonBackground" Value="{StaticResource RimworldLightBrownBrush}"/>
                        <Setter Property="Foreground" Value="{StaticResource RimworldDarkBrownBrush}"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>
                    <!-- RimWorld-style Save Button -->
                    <Style x:Key="RimworldSaveButtonStyle"
                            TargetType="Button"
                            BasedOn="{StaticResource RimworldButtonStyle}">
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="Button">
                                    <Grid>
                                        <Border x:Name="ButtonBackground"
                                                Background="{StaticResource RimworldDarkGreenBrush}"
                                                BorderBrush="#1B3021"
                                                BorderThickness="1"
                                                CornerRadius="3"
                                                Margin="0,0,0,2">
                                            <Border.Effect>
                                                <DropShadowEffect Color="#222222"
                                                        Direction="320"
                                                        ShadowDepth="1"
                                                        BlurRadius="2"
                                                        Opacity="0.3"/>
                                            </Border.Effect>
                                        </Border>

                                        <Border Background="Transparent"
                                                BorderBrush="#1B3021"
                                                BorderThickness="1"
                                                CornerRadius="3"
                                                Margin="0,0,0,2">
                                            <ContentPresenter HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"/>
                                        </Border>
                                    </Grid>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver"
                                                Value="True">
                                            <Setter Property="Background"
                                                    TargetName="ButtonBackground"
                                                    Value="#3C5F46"/>
                                        </Trigger>
                                        <Trigger Property="IsPressed"
                                                Value="True">
                                            <Setter Property="Margin"
                                                    TargetName="ButtonBackground"
                                                    Value="0,1,0,1"/>
                                        </Trigger>
                                        <Trigger Property="IsEnabled"
                                                Value="False">
                                            <Setter Property="Background"
                                                    TargetName="ButtonBackground"
                                                    Value="#5A6F61"/>
                                            <Setter Property="Foreground"
                                                    Value="#BBBBBB"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>

                    <!-- RimWorld-style Run Button -->
                    <Style x:Key="RimworldRunButtonStyle"
                            TargetType="Button"
                            BasedOn="{StaticResource RimworldButtonStyle}">
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="Button">
                                    <Grid>
                                        <Border x:Name="ButtonBackground"
                                                Background="{StaticResource RimworldRedBrush}"
                                                BorderBrush="#7A1F1F"
                                                BorderThickness="1"
                                                CornerRadius="3"
                                                Margin="0,0,0,2">
                                            <Border.Effect>
                                                <DropShadowEffect Color="#222222"
                                                        Direction="320"
                                                        ShadowDepth="1"
                                                        BlurRadius="2"
                                                        Opacity="0.3"/>
                                            </Border.Effect>
                                        </Border>

                                        <Border Background="Transparent"
                                                BorderBrush="#7A1F1F"
                                                BorderThickness="1"
                                                CornerRadius="3"
                                                Margin="0,0,0,2">
                                            <ContentPresenter HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"/>
                                        </Border>
                                    </Grid>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver"
                                                Value="True">
                                            <Setter Property="Background"
                                                    TargetName="ButtonBackground"
                                                    Value="#B13434"/>
                                        </Trigger>
                                        <Trigger Property="IsPressed"
                                                Value="True">
                                            <Setter Property="Margin"
                                                    TargetName="ButtonBackground"
                                                    Value="0,1,0,1"/>
                                        </Trigger>
                                        <Trigger Property="IsEnabled"
                                                Value="False">
                                            <Setter Property="Background"
                                                    TargetName="ButtonBackground"
                                                    Value="#8A5656"/>
                                            <Setter Property="Foreground"
                                                    Value="#BBBBBB"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>

                    <!-- RimWorld-style Tab Buttons -->
                    <Style x:Key="RimworldTabButtonStyle"
                            TargetType="Button">
                        <Setter Property="Foreground"
                                Value="#FFFFFF"/>
                        <Setter Property="Padding"
                                Value="12,6"/>
                        <Setter Property="MinWidth"
                                Value="80"/>
                        <Setter Property="FontWeight"
                                Value="Medium"/>
                        <Setter Property="Margin"
                                Value="0,0,5,0"/>
                        <Setter Property="IsEnabled">
                            <Setter.Value>
                                <MultiBinding Converter="{StaticResource InequalityConverter}">
                                    <Binding Path="DataContext.SelectedTab"
                                            RelativeSource="{RelativeSource AncestorType={x:Type Window}}"/>
                                    <Binding Path="CommandParameter"
                                            RelativeSource="{RelativeSource Self}"/>
                                </MultiBinding>
                            </Setter.Value>
                        </Setter>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="Button">
                                    <Grid>
                                        <Border x:Name="ButtonBackground"
                                                Background="{StaticResource RimworldLightBrownBrush}"
                                                BorderBrush="{StaticResource RimworldBrownBrush}"
                                                BorderThickness="1,1,1,0"
                                                CornerRadius="3,3,0,0">
                                        </Border>

                                        <ContentPresenter HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                Margin="{TemplateBinding Padding}"/>
                                    </Grid>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsEnabled"
                                                Value="False">
                                            <Setter Property="Background"
                                                    TargetName="ButtonBackground"
                                                    Value="{StaticResource RimworldBrownBrush}"/>
                                            <Setter Property="FontWeight"
                                                    Value="Bold"/>
                                        </Trigger>
                                        <Trigger Property="IsMouseOver"
                                                Value="True">
                                            <Setter Property="Background"
                                                    TargetName="ButtonBackground"
                                                    Value="{StaticResource RimworldDarkBeigeBrush}"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>

                    <!-- RimWorld-style TextBox -->
                    <Style x:Key="RimworldTextBox"
                            TargetType="TextBox">
                        <Setter Property="Background"
                                Value="{StaticResource RimworldBeigeBrush}"/>
                        <Setter Property="Foreground"
                                Value="{StaticResource RimworldBrownBrush}"/>
                        <Setter Property="BorderBrush"
                                Value="{StaticResource RimworldBrownBrush}"/>
                        <Setter Property="BorderThickness"
                                Value="1"/>
                        <Setter Property="Padding"
                                Value="5,3"/>
                        <Setter Property="VerticalContentAlignment"
                                Value="Center"/>
                    </Style>

                    <!-- RimWorld-style Watermark TextBox -->
                    <Style x:Key="RimworldWatermarkTextBox"
                            TargetType="{x:Type TextBox}">
                        <Setter Property="Background"
                                Value="{StaticResource RimworldBeigeBrush}"/>
                        <Setter Property="Foreground"
                                Value="{StaticResource RimworldBrownBrush}"/>
                        <Setter Property="BorderBrush"
                                Value="{StaticResource RimworldBrownBrush}"/>
                        <Setter Property="BorderThickness"
                                Value="1"/>
                        <Setter Property="Padding"
                                Value="5,3"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type TextBox}">
                                    <Grid>
                                        <Border Background="{TemplateBinding Background}"
                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                CornerRadius="2">
                                            <Border.Effect>
                                                <DropShadowEffect ShadowDepth="1"
                                                        Direction="270"
                                                        Color="#33000000"
                                                        BlurRadius="1"
                                                        Opacity="0.5"/>
                                            </Border.Effect>
                                        </Border>
                                        <TextBox Text="{Binding Path=Text, RelativeSource={RelativeSource TemplatedParent},
                                                 UpdateSourceTrigger=PropertyChanged}"
                                                 x:Name="textSource"
                                                 Background="Transparent"
                                                 BorderThickness="0"
                                                 Padding="{TemplateBinding Padding}"
                                                 Foreground="{TemplateBinding Foreground}"
                                                 VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"
                                                 Panel.ZIndex="2"/>
                                        <TextBlock Text="{TemplateBinding Tag}"
                                                   Foreground="{StaticResource RimworldLightBrownBrush}"
                                                IsHitTestVisible="False"
                                                   Margin="6,3"
                                                VerticalAlignment="Center"
                                                   Panel.ZIndex="1">
                                            <TextBlock.Style>
                                                <Style TargetType="{x:Type TextBlock}">
                                                    <Setter Property="Visibility"
                                                            Value="Collapsed"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Path=Text, Source={x:Reference textSource}}"
                                                                Value="">
                                                            <Setter Property="Visibility"
                                                                    Value="Visible"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </Grid>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>

                    <!-- RimWorld-style ListBox -->
                    <Style x:Key="RimworldListBox"
                            TargetType="ListBox">
                        <Setter Property="Background"
                                Value="{StaticResource RimworldBeigeBrush}"/>
                        <Setter Property="BorderBrush"
                                Value="{StaticResource RimworldBrownBrush}"/>
                        <Setter Property="BorderThickness"
                                Value="1"/>
                        <Setter Property="Padding"
                                Value="1"/>
                        <Setter Property="ScrollViewer.HorizontalScrollBarVisibility"
                                Value="Disabled"/>
                        <Setter Property="ScrollViewer.VerticalScrollBarVisibility"
                                Value="Auto"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="ListBox">
                                    <Border Background="{TemplateBinding Background}"
                                            BorderBrush="{TemplateBinding BorderBrush}"
                                            BorderThickness="{TemplateBinding BorderThickness}"
                                            CornerRadius="3">
                                        <ScrollViewer Focusable="False"
                                                Padding="{TemplateBinding Padding}">
                                            <ItemsPresenter/>
                                        </ScrollViewer>
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                        <Setter Property="ItemContainerStyle">
                            <Setter.Value>
                                <Style TargetType="ListBoxItem">
                                    <Setter Property="Padding"
                                            Value="5,4"/>
                                    <Setter Property="HorizontalContentAlignment"
                                            Value="Stretch"/>
                                    <Setter Property="VerticalContentAlignment"
                                            Value="Center"/>
                                    <Setter Property="Background"
                                            Value="Transparent"/>
                                    <Setter Property="BorderThickness"
                                            Value="0"/>
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="ListBoxItem">
                                                <Border x:Name="Bd"
                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                        Background="{TemplateBinding Background}"
                                                        Padding="{TemplateBinding Padding}"
                                                        SnapsToDevicePixels="true">
                                                    <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                                      VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="IsMouseOver"
                                                            Value="true">
                                                        <Setter Property="Background"
                                                                TargetName="Bd"
                                                                Value="{StaticResource RimworldDarkBeigeBrush}"/>
                                                    </Trigger>
                                                    <Trigger Property="IsSelected"
                                                            Value="true">
                                                        <Setter Property="Background"
                                                                TargetName="Bd"
                                                                Value="{StaticResource RimworldLightBrownBrush}"/>
                                                        <Setter Property="Foreground"
                                                                Value="White"/>
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </Setter.Value>
                        </Setter>
                    </Style>

                    <!-- RimWorld-style ComboBox -->
                    <Style x:Key="RimworldComboBox"
                            TargetType="ComboBox">
                        <Setter Property="Background"
                                Value="{StaticResource RimworldBeigeBrush}"/>
                        <Setter Property="Foreground"
                                Value="{StaticResource RimworldBrownBrush}"/>
                        <Setter Property="BorderBrush"
                                Value="{StaticResource RimworldBrownBrush}"/>
                        <Setter Property="BorderThickness"
                                Value="1"/>
                        <Setter Property="Padding"
                                Value="6,3"/>
                    </Style>

                    <!-- RimWorld-style Window Background -->
                    <Style x:Key="RimworldWindowBackground"
                            TargetType="Window">
                        <Setter Property="Background"
                                Value="{StaticResource RimworldBeigeBrush}"/>
                    </Style>

                    <!-- Styles for list header -->
                    <Style x:Key="RimworldListHeaderBorder"
                            TargetType="Border">
                        <Setter Property="Background"
                                Value="{StaticResource RimworldLightBrownBrush}"/>
                        <Setter Property="BorderBrush"
                                Value="{StaticResource RimworldBrownBrush}"/>
                        <Setter Property="BorderThickness"
                                Value="0,0,0,1"/>
                        <Setter Property="Padding"
                                Value="7,5"/>
                    </Style>

                    <!-- Style for mod info panel header -->
                    <Style x:Key="RimworldModInfoHeader"
                            TargetType="Border">
                        <Setter Property="Background"
                                Value="{StaticResource RimworldBrownBrush}"/>
                        <Setter Property="Padding"
                                Value="20"/>
                    </Style>
                </ResourceDictionary>
            </ResourceDictionary.MergedDictionaries>

            <!-- DataTemplates to link ViewModels to Views for the ContentControl -->
            <DataTemplate DataType="{x:Type vmMods:ModsViewModel}">
                <vMods:ModsView/>
            </DataTemplate>

            <DataTemplate DataType="{x:Type vmDownloader:DownloaderViewModel}">
                <vDownloader:DownloaderView/>
            </DataTemplate>


        </ResourceDictionary>
    </Application.Resources>
</Application>